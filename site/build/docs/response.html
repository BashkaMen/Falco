<!DOCTYPE html>
<html lang="en">

<!-- /head -->
<head>
  <meta charset="utf-8">
  <meta content="width=device-width,initial-scale=1" name="viewport">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  
      <title>Falco - F# web toolkit for ASP.NET Core</title>
    
  <meta name="description" content="A functional-first toolkit for building brilliant ASP.NET Core applications using F#.">

  <!-- /head/style -->
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
  <link href="/prism.css" rel="stylesheet" />
  <link href="/tachyons.css" rel="stylesheet" />
  <style>
    :root {
      --gray: rgba(51,51,51,.6);
      --silver: rgb(204, 204, 204);
      --slate: rgb(51, 51, 51);
      --merlot: rgb(50, 1, 79);
      --purple: rgb(184, 69, 252);
      --washed-purple: rgba(185, 69, 252, 0.10);
    }

    /* sizing */
    .h100vh { min-height: 100vh }
    .mw9 { max-width: 80rem }

    /* font */
    .noto { font-family: 'Noto Sans JP', sans-serif }
    .noto-serif { font-family: 'Noto Serif JP', Georgia, serif }

    /* bg */
    .bg-merlot { background-color: var(--merlot) }
    .bg-dots { background-image: radial-gradient(rgba(255,255,255,.3) 1px, transparent 1px), radial-gradient(rgba(255,255,255,.3) 1px, transparent 1px); background-size: 75px 75px; background-position: 0px 0px,40px 25px }
    .bg-parallax {  background-attachment: fixed }

    /* color */
    .merlot { color: var(--merlot) }

    /* opacity */
    .hover-o-100:hover { opacity: 1 }

    /* transform */
    .ty--50 { transform: translateY(-50%);}

    /* text */
    main h1, main h2, main h3, main h4, main h5 { margin-bottom: 0; font-weight: 400 }
    main h2 { margin-top: 3rem; font-size: 2em; color: var(--gray) }
    main h3 { margin-top: 2rem; font-size: 1.5em }
    main h2 + h3 { margin-top: .5rem }
    main p { line-height: 1.4 }

    a { color: inherit; transition: color .125s ease-in }
    main a:visited { color: inherit }
    main a:hover { color: var(--purple) }

    blockquote { margin-left: 0; margin-right: 0; padding: 1rem; border-left: 4px solid var(--purple); background: var(--washed-purple) }
    blockquote p { margin: 0 }

    /* tables */
    table { text-align: left; border-collapse: collapse }
    td, th { padding: .5rem; border-bottom: 1px solid var(--silver) }

    /* code */
    code[class*="language-"], pre[class*="language-"] { font-size: .875rem }
    pre[class*="language-"] { padding: 1rem }
    pre { overflow-x: auto; overflow-wrap: normal; white-space: pre; font-size: .875rem; margin: 1rem 0; padding: 1rem; color: #eff0f9; background: #333 }
    code { vertical-align: middle; font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace; background-color: var(--washed-purple) }
    pre > code { background-color: inherit }
    h2 > code, h3 > code, p > code { padding: 0 .25rem }
  </style>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D62HSJHMNZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D62HSJHMNZ');
  </script>
</head>

<!-- /body -->
<body class="noto bg-merlot bg-dots bg-parallax">

<!-- /body/header -->
<header class="pv3">
  <div class="mw8 center pa3">
    <!-- /top bar -->
    <div>
      <nav class="flex flex-column flex-row-l items-center">
        <a href="/"><img src="/icon.svg" class="w3 pb3 pb0-l o-80 hover-o-100" /></a>
        <div class="flex-grow-1-l tc tr-l">
          <a href="/docs" title="Overview of Falco's key features" class="dib mh2 mh3-l no-underline white-90 hover-white">docs</a>
          <a href="/docs/tutorial.html" title="A guide on how to write small, but complete application using Falco" class="dib mh2 mh3-l no-underline white-90 hover-white">guide</a>
          <a href="https://github.com/pimbrouwers/Falco"
             target="_blank"
             alt="Falco GitHub Link"
             title="Fork Falco on GitHub"
             class="dib ml2 ml3-l no-underline white-90 hover-white">code</a>
        </div>
      </nav>
    </div>
    
  </div>
</header>

<!-- /body/content -->
<div class="h100vh bg-white">
  <div class="cf mw8 center pv4 pv5-l ph3">
    <main><h1 id="response-writing">Response Writing</h1>
<p>The <code>Response</code> module contains a series of functions that provide support for the most common response types.</p>
<h2 id="plain-text-responses">Plain Text responses</h2>
<pre><code class="language-fsharp">let textHandler : HttpHandler =
    Response.ofPlainText &quot;hello world&quot;
</code></pre>
<h2 id="html-responses">HTML responses</h2>
<p>Write your views in plain F#, directly in your assembly, using the <a href="markup.html"><code>Markup</code></a> module. A performant F# DSL capable of generating any angle-bracket markup. Also available directly as a standalone <a href="https://www.nuget.org/packages/Falco.Markup">NuGet</a> package.</p>
<pre><code class="language-fsharp">let htmlHandler : HttpHandler =
    let html =
        Elem.html [ Attr.lang &quot;en&quot; ] [
            Elem.head [] []
            Elem.body [] [
                Elem.h1 [] [ Text.raw &quot;Sample App&quot; ]
            ]
        ]

    Response.ofHtml html

// Automatically protect against XSS attacks
let secureHtmlHandler : HttpHandler =
    let html token =
        Elem.html [] [
            Elem.body [] [
                Elem.form [ Attr.method &quot;post&quot; ] [
                    Elem.input [ Attr.name &quot;first_name&quot; ]

                    Elem.input [ Attr.name &quot;last_name&quot; ]

                    // using the CSRF HTML helper
                    Xss.antiforgeryInput token

                    Elem.input [ Attr.type' &quot;submit&quot;; Attr.value &quot;Submit&quot; ]
                ]
            ]
        ]

    Response.ofHtmlCsrf html
</code></pre>
<p>Alternatively, if you're using an external view engine and want to return an HTML response from a string literal, then you can use <code>Response.ofHtmlString</code>.</p>
<pre><code class="language-fsharp">let htmlHandler : HttpHandler =
    Response.ofHtmlString &quot;&lt;html&gt;...&lt;/html&gt;&quot;
</code></pre>
<h2 id="json-responses">JSON responses</h2>
<p>These handlers use the .NET built-in <code>System.Text.Json.JsonSerializer</code>.</p>
<pre><code class="language-fsharp">type Person =
    { First : string
      Last  : string }

let jsonHandler : HttpHandler =
    let name = { First = &quot;John&quot;; Last = &quot;Doe&quot; }
    Response.ofJson name

let jsonOptionsHandler : HttpHandler =
    let options = JsonSerializerOptions()
    options.IgnoreNullValues &lt;- true
    let name = { First = &quot;John&quot;; Last = &quot;Doe&quot; }
    Response.ofJson options name
</code></pre>
<h2 id="redirect-301302-response">Redirect (301/302) Response</h2>
<pre><code class="language-fsharp">let oldUrlHandler : HttpHandler =
    Response.redirectPermanently &quot;/new-url&quot; // HTTP 301

let redirectUrlHandler : HttpHandler =
    Response.redirectTemporarily &quot;/new-url&quot; // HTTP 302
</code></pre>
<h2 id="content-disposition">Content Disposition</h2>
<pre><code class="language-fsharp">let inlineBinaryHandler : HttpHandler =
    let contentType = &quot;image/jpeg&quot;
    let headers = [ HeaderNames.CacheControl,  &quot;no-store, max-age=0&quot; ]
    let bytes = // ... binary data
    Response.ofBinary contentType headers bytes

let attachmentHandler : HttpHandler =
    let filename = &quot;profile.jpg&quot;
    let contentType = &quot;image/jpeg&quot;
    let headers = [ HeaderNames.CacheControl,  &quot;no-store, max-age=0&quot; ]
    let bytes = // ... binary data
    Response.ofAttachment filename contentType headers bytes
</code></pre>
<h2 id="response-modifiers">Response Modifiers</h2>
<p>Response modifiers can be thought of as the in-and-out modification of the <code>HttpResponse</code>. A preamble to writing and returning. Since these functions receive the <code>Httpcontext</code> as input and return it as the only output, they can take advantage of function compoistion.</p>
<h3 id="set-the-status-code-of-the-response">Set the status code of the response</h3>
<pre><code class="language-fsharp">let notFoundHandler : HttpHandler =
    Response.withStatusCode 404
    &gt;&gt; Response.ofPlainText &quot;Not found&quot;
</code></pre>
<h3 id="add-a-headers-to-the-response">Add a header(s) to the response</h3>
<pre><code class="language-fsharp">let handlerWithHeader : HttpHandler =
    Response.withHeader &quot;Content-Language&quot; &quot;en-us&quot;
    &gt;&gt; Response.ofPlainText &quot;Hello world&quot;

let handlerWithHeaders : HttpHandler =
    Response.withHeaders [ &quot;Content-Language&quot; &quot;en-us&quot; ]
    &gt;&gt; Response.ofPlainText &quot;Hello world&quot;
</code></pre>
<h3 id="add-a-cookie-to-the-response">Add a cookie to the response</h3>
<blockquote>
<p>IMPORTANT: <em>Do not</em> use this for authentication. Instead use the <code>Response.signInAndRedirect</code> and <code>Response.signOutAndRedirect</code> functions found in the <a href="security.html">Authentication</a> module.</p>
</blockquote>
<pre><code class="language-fsharp">let handlerWithCookie : HttpHandler =
    Response.withCookie &quot;greeted&quot; &quot;1&quot;
    &gt;&gt; Response.ofPlainText &quot;Hello world&quot;

let handlerWithCookieOptions : HttpHandler =
    let options = CookieOptions()
    options.Expires &lt;- DateTime.Now.Minutes(15)
    Response.withCookie options &quot;greeted&quot; &quot;1&quot;
    &gt;&gt; Response.ofPlainText &quot;Hello world&quot;
</code></pre>
</main>
  </div>
</div>

<!-- /body/footer -->
<footer class="tc ph3 pv4">
  <div class="f6 white-90">&copy; 2020-2022 Pim Brouwers & contributors.</div>
</footer>

<!-- /body/script -->
<script src="/prism.js"></script>

</body>
</html>
